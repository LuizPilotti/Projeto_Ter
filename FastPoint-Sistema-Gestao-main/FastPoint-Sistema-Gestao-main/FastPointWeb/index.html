<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - FastPoint</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #212529; height: 100vh; display: flex; align-items: center; justify-content: center; }
        
        /* For√ßa texto branco no cart√£o e labels */
        .card { background-color: #343a40; border: none; color: #ffffff !important; }
        .form-label, h3 { color: #ffffff !important; }

        .btn-primary { background-color: #ffc107; border-color: #ffc107; color: black; font-weight: bold; }
        .btn-primary:hover { background-color: #e0a800; border-color: #e0a800; }
    </style>
</head>
<body>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-4">
                <div class="card p-4 shadow-lg">
                    <h3 class="text-center mb-4">üçî FastPoint</h3>
                    <div id="alerta" class="alert alert-danger d-none" role="alert"></div>
                    
                    <form id="formLogin">
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" id="email" class="form-control" placeholder="admin@fastpoint.com" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Senha</label>
                            <input type="password" id="senha" class="form-control" placeholder="******" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">ENTRAR</button>
                        <div class="text-center">
                            <a href="cadastro.html" style="color: #ffc107; text-decoration: none;">N√£o tem conta? Crie aqui</a>
                         </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = "http://localhost:5010/api"; // CONFIRA SE A PORTA √â ESSA MESMO

        document.getElementById("formLogin").addEventListener("submit", async (e) => {
            e.preventDefault();
            const email = document.getElementById("email").value;
            const senha = document.getElementById("senha").value;
            const alerta = document.getElementById("alerta");

            try {
                const response = await fetch(`${API_URL}/Usuarios/login?email=${email}&senha=${senha}`, {
                    method: "POST"
                });

                if (response.ok) {
                    const data = await response.json();
                    // Salva o Token no navegador para usar depois
                    localStorage.setItem("token", data.token);
                    localStorage.setItem("usuario", data.usuario);
                    localStorage.setItem("perfil", data.perfil);
                    
                    // Manda para a tela de produtos
                    window.location.href = "dashboard.html"; 
                } else {
                    alerta.textContent = "Usu√°rio ou senha inv√°lidos!";
                    alerta.classList.remove("d-none");
                }
            } catch (error) {
                console.error(error);
                alerta.textContent = "Erro ao conectar com o servidor.";
                alerta.classList.remove("d-none");
            }
        });
    </script>
</body>
</html>