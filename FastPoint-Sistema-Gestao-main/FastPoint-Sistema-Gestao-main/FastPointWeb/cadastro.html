<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Nova Conta - FastPoint</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Fundo escuro para a p√°gina */
        body { 
            background-color: #212529; 
            height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        
        /* Cart√£o com fundo cinza e TEXTO BRANCO FOR√áADO */
        .card { 
            background-color: #343a40; 
            border: none; 
            color: #ffffff !important; /* O segredo est√° aqui */
        }

        /* Garante que os t√≠tulos e labels sejam brancos */
        h3, .form-label {
            color: #ffffff !important;
        }

        /* Bot√£o verde */
        .btn-success { 
            background-color: #198754; 
            border-color: #198754; 
            font-weight: bold; 
        }

        /* Link amarelo */
        a { 
            text-decoration: none; 
            color: #ffc107; 
        }
        a:hover { color: #e0a800; }
    </style>
</head>
<body>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-5">
                <div class="card p-4 shadow-lg">
                    <h3 class="text-center mb-4">üìù Criar Conta</h3>
                    <div id="alerta" class="alert alert-danger d-none" role="alert"></div>
                    
                    <form id="formCadastro">
                        <div class="mb-3">
                            <label class="form-label">Nome Completo</label>
                            <input type="text" id="nome" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" id="email" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Senha</label>
                            <input type="password" id="senha" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Perfil</label>
                            <select id="perfil" class="form-select">
                                <option value="Atendente">Atendente</option>
                                <option value="Gerente">Gerente</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-success w-100 mb-3">CADASTRAR</button>
                        <div class="text-center">
                            <a href="index.html">J√° tem conta? Voltar para Login</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = "http://localhost:5010/api";

        document.getElementById("formCadastro").addEventListener("submit", async (e) => {
            e.preventDefault();
            
            const usuario = {
                nome: document.getElementById("nome").value,
                email: document.getElementById("email").value,
                senha: document.getElementById("senha").value,
                perfil: document.getElementById("perfil").value
            };

            try {
                const response = await fetch(`${API_URL}/Usuarios/registrar`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(usuario)
                });

                if (response.ok) {
                    alert("Conta criada com sucesso! Fa√ßa login.");
                    window.location.href = "index.html";
                } else {
                    // Tenta ler a mensagem de erro, se falhar usa uma gen√©rica
                    let msg = "Erro ao cadastrar.";
                    try { msg = await response.text(); } catch {}
                    
                    document.getElementById("alerta").textContent = "Erro: " + msg;
                    document.getElementById("alerta").classList.remove("d-none");
                }
            } catch (error) {
                console.error(error);
                alert("Erro ao conectar com o servidor.");
            }
        });
    </script>
</body>
</html>